SEL-5010 Relay Assistant Software 
Version: 4.36.1.0
Date Code: 20100202


SEL-5010 Relay Assistant Software is vulnerable to a stack buffer overflow
due to a third party activex control. The module dwStg.dll (2.5.0.26) can
be abused to execute arbitrary code in the context of the currently
logged-in user.



//debug

FAULTING_IP:
dwStg+172f
1000172f 8b08            mov     ecx,dword ptr [eax]

EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)
ExceptionAddress: 1000172f (dwStg+0x0000172f)
   ExceptionCode: c0000005 (Access violation)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 00000000
   Parameter[1]: 41414141
Attempt to read from address 41414141

FAULTING_THREAD:  0000107c

PROCESS_NAME:  wscript.exe

ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%08lx referenced memory
 at 0x%08lx. The memory could not be %s.

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%08lx referenced me
mory at 0x%08lx. The memory could not be %s.

EXCEPTION_PARAMETER1:  00000000

EXCEPTION_PARAMETER2:  41414141

READ_ADDRESS:  41414141

FOLLOWUP_IP:
dwStg+172f
1000172f 8b08            mov     ecx,dword ptr [eax]

NTGLOBALFLAG:  70

APPLICATION_VERIFIER_FLAGS:  0

BUGCHECK_STR:  APPLICATION_FAULT_STRING_DEREFERENCE_INVALID_POINTER_READ_FILL_PA
TTERN_41414141

PRIMARY_PROBLEM_CLASS:  STRING_DEREFERENCE_FILL_PATTERN_41414141

DEFAULT_BUCKET_ID:  STRING_DEREFERENCE_FILL_PATTERN_41414141

IP_ON_HEAP:  41414141
The fault address in not in any loaded module, please check your build's rebase
log at <releasedir>\bin\build_logs\timebuild\ntrebase.log for module which may
contain the address if it were loaded.

IP_IN_FREE_BLOCK: 41414141

FRAME_ONE_INVALID: 1

LAST_CONTROL_TRANSFER:  from 41414141 to 1000172f

STACK_TEXT:
WARNING: Stack unwind information not available. Following frames may be wrong.
0025e888 41414141 41414141 41414141 41414141 dwStg+0x172f
0025e88c 41414141 41414141 41414141 41414141 0x41414141
0025e890 41414141 41414141 41414141 41414141 0x41414141
0025e894 41414141 41414141 41414141 41414141 0x41414141
0025e898 41414141 41414141 41414141 41414141 0x41414141
0025e89c 41414141 41414141 41414141 41414141 0x41414141
0025e8a0 41414141 41414141 41414141 41414141 0x41414141
0025e8a4 41414141 41414141 41414141 41414141 0x41414141
0025e8a8 41414141 41414141 41414141 41414141 0x41414141
0025e8ac 41414141 41414141 41414141 41414141 0x41414141
0025e8b0 41414141 41414141 41414141 41414141 0x41414141
0025e8b4 41414141 41414141 41414141 41414141 0x41414141
0025e8b8 41414141 41414141 41414141 41414141 0x41414141
0025e8bc 41414141 41414141 41414141 41414141 0x41414141
0025e8c0 41414141 41414141 41414141 41414141 0x41414141
0025e8c4 41414141 41414141 41414141 41414141 0x41414141
0025e8c8 41414141 41414141 41414141 41414141 0x41414141
0025e8cc 41414141 41414141 41414141 41414141 0x41414141
0025e8d0 41414141 41414141 41414141 41414141 0x41414141
0025e8d4 41414141 41414141 41414141 41414141 0x41414141
0025e8d8 41414141 41414141 41414141 41414141 0x41414141
0025e8dc 41414141 41414141 41414141 41414141 0x41414141
0025e8e0 41414141 41414141 41414141 41414141 0x41414141
0025e8e4 41414141 41414141 41414141 41414141 0x41414141
0025e8e8 41414141 41414141 41414141 41414141 0x41414141
0025e8ec 41414141 41414141 41414141 41414141 0x41414141
0025e8f0 41414141 41414141 41414141 41414141 0x41414141
0025e8f4 41414141 41414141 41414141 41414141 0x41414141
0025e8f8 41414141 41414141 41414141 41414141 0x41414141
0025e8fc 41414141 41414141 41414141 41414141 0x41414141
0025e900 41414141 41414141 41414141 41414141 0x41414141
0025e904 41414141 41414141 41414141 41414141 0x41414141
0025e908 41414141 41414141 41414141 41414141 0x41414141
0025e90c 41414141 41414141 41414141 41414141 0x41414141
0025e910 41414141 41414141 41414141 41414141 0x41414141
0025e914 41414141 41414141 41414141 41414141 0x41414141
0025e918 41414141 41414141 41414141 41414141 0x41414141
0025e91c 41414141 41414141 41414141 41414141 0x41414141
0025e920 41414141 41414141 41414141 41414141 0x41414141
0025e924 41414141 41414141 41414141 41414141 0x41414141
0025e928 41414141 41414141 41414141 41414141 0x41414141
0025e92c 41414141 41414141 41414141 41414141 0x41414141
0025e930 41414141 41414141 41414141 41414141 0x41414141
0025e934 41414141 41414141 41414141 41414141 0x41414141
0025e938 41414141 41414141 41414141 41414141 0x41414141
0025e93c 41414141 41414141 41414141 41414141 0x41414141
0025e940 41414141 41414141 41414141 41414141 0x41414141
0025e944 41414141 41414141 41414141 41414141 0x41414141
0025e948 41414141 41414141 41414141 41414141 0x41414141
0025e94c 41414141 41414141 41414141 41414141 0x41414141
0025e950 41414141 41414141 41414141 41414141 0x41414141
0025e954 41414141 41414141 41414141 41414141 0x41414141
0025e958 41414141 41414141 41414141 41414141 0x41414141
0025e95c 41414141 41414141 41414141 41414141 0x41414141
0025e960 41414141 41414141 41414141 41414141 0x41414141
0025e964 41414141 41414141 41414141 41414141 0x41414141
0025e968 41414141 41414141 41414141 41414141 0x41414141
0025e96c 41414141 41414141 41414141 41414141 0x41414141
0025e970 41414141 41414141 41414141 41414141 0x41414141
0025e974 41414141 41414141 41414141 41414141 0x41414141
0025e978 41414141 41414141 41414141 41414141 0x41414141
0025e97c 41414141 41414141 41414141 41414141 0x41414141
0025e980 41414141 41414141 41414141 41414141 0x41414141
0025e984 41414141 41414141 41414141 41414141 0x41414141
0025e988 41414141 41414141 41414141 41414141 0x41414141
0025e98c 41414141 41414141 41414141 41414141 0x41414141
0025e990 41414141 41414141 41414141 41414141 0x41414141
0025e994 41414141 41414141 41414141 41414141 0x41414141
0025e998 41414141 41414141 41414141 41414141 0x41414141
0025e99c 41414141 41414141 41414141 41414141 0x41414141
0025e9a0 41414141 41414141 41414141 41414141 0x41414141
0025e9a4 41414141 41414141 41414141 41414141 0x41414141
0025e9a8 41414141 41414141 41414141 41414141 0x41414141
0025e9ac 41414141 41414141 41414141 41414141 0x41414141
0025e9b0 41414141 41414141 41414141 41414141 0x41414141
0025e9b4 41414141 41414141 41414141 41414141 0x41414141
0025e9b8 41414141 41414141 41414141 41414141 0x41414141
0025e9bc 41414141 41414141 41414141 41414141 0x41414141
0025e9c0 41414141 41414141 41414141 41414141 0x41414141
0025e9c4 41414141 41414141 41414141 41414141 0x41414141
0025e9c8 41414141 41414141 41414141 41414141 0x41414141
0025e9cc 41414141 41414141 41414141 41414141 0x41414141
0025e9d0 41414141 41414141 41414141 41414141 0x41414141
0025e9d4 41414141 41414141 41414141 41414141 0x41414141
0025e9d8 41414141 41414141 41414141 41414141 0x41414141
0025e9dc 41414141 41414141 41414141 41414141 0x41414141
0025e9e0 41414141 41414141 41414141 41414141 0x41414141
0025e9e4 41414141 41414141 41414141 41414141 0x41414141
0025e9e8 41414141 41414141 41414141 41414141 0x41414141
0025e9ec 41414141 41414141 41414141 41414141 0x41414141
0025e9f0 41414141 41414141 41414141 41414141 0x41414141
0025e9f4 41414141 41414141 41414141 41414141 0x41414141
0025e9f8 41414141 41414141 41414141 41414141 0x41414141
0025e9fc 41414141 41414141 41414141 41414141 0x41414141
0025ea00 41414141 41414141 41414141 41414141 0x41414141
0025ea04 41414141 41414141 41414141 41414141 0x41414141
0025ea08 41414141 41414141 41414141 41414141 0x41414141
0025ea0c 41414141 41414141 41414141 41414141 0x41414141
0025ea10 41414141 41414141 41414141 41414141 0x41414141
0025ea14 41414141 41414141 41414141 41414141 0x41414141
0025ea18 41414141 41414141 41414141 41414141 0x41414141
0025ea1c 41414141 41414141 41414141 41414141 0x41414141
0025ea20 41414141 41414141 41414141 41414141 0x41414141
0025ea24 41414141 41414141 41414141 41414141 0x41414141
0025ea28 41414141 41414141 41414141 41414141 0x41414141
0025ea2c 41414141 41414141 41414141 41414141 0x41414141
0025ea30 41414141 41414141 41414141 41414141 0x41414141
0025ea34 41414141 41414141 41414141 41414141 0x41414141
0025ea38 41414141 41414141 41414141 41414141 0x41414141
0025ea3c 41414141 41414141 41414141 41414141 0x41414141
0025ea40 41414141 41414141 41414141 41414141 0x41414141
0025ea44 41414141 41414141 41414141 41414141 0x41414141
0025ea48 41414141 41414141 41414141 41414141 0x41414141
0025ea4c 41414141 41414141 41414141 41414141 0x41414141
0025ea50 41414141 41414141 41414141 41414141 0x41414141
0025ea54 41414141 41414141 41414141 41414141 0x41414141
0025ea58 41414141 41414141 41414141 41414141 0x41414141
0025ea5c 41414141 41414141 41414141 41414141 0x41414141
0025ea60 41414141 41414141 41414141 41414141 0x41414141
0025ea64 41414141 41414141 41414141 41414141 0x41414141
0025ea68 41414141 41414141 41414141 41414141 0x41414141
0025ea6c 41414141 41414141 41414141 41414141 0x41414141
0025ea70 41414141 41414141 41414141 41414141 0x41414141
0025ea74 41414141 41414141 41414141 41414141 0x41414141
0025ea78 41414141 41414141 41414141 41414141 0x41414141
0025ea7c 41414141 41414141 41414141 41414141 0x41414141
0025ea80 41414141 41414141 41414141 41414141 0x41414141
0025ea84 41414141 41414141 41414141 41414141 0x41414141
0025ea88 41414141 41414141 41414141 41414141 0x41414141
0025ea8c 41414141 41414141 41414141 41414141 0x41414141
0025ea90 41414141 41414141 41414141 41414141 0x41414141
0025ea94 41414141 41414141 41414141 41414141 0x41414141
0025ea98 41414141 41414141 41414141 41414141 0x41414141
0025ea9c 41414141 41414141 41414141 41414141 0x41414141
0025eaa0 41414141 41414141 41414141 41414141 0x41414141
0025eaa4 41414141 41414141 41414141 41414141 0x41414141
0025eaa8 41414141 41414141 41414141 41414141 0x41414141
0025eaac 41414141 41414141 41414141 41414141 0x41414141
0025eab0 41414141 41414141 41414141 41414141 0x41414141
0025eab4 41414141 41414141 41414141 41414141 0x41414141
0025eab8 41414141 41414141 41414141 41414141 0x41414141
0025eabc 41414141 41414141 41414141 41414141 0x41414141
0025eac0 41414141 41414141 41414141 41414141 0x41414141
0025eac4 41414141 41414141 41414141 41414141 0x41414141
0025eac8 41414141 41414141 41414141 41414141 0x41414141
0025eacc 41414141 41414141 41414141 41414141 0x41414141
0025ead0 41414141 41414141 41414141 41414141 0x41414141
0025ead4 41414141 41414141 41414141 41414141 0x41414141
0025ead8 41414141 41414141 41414141 41414141 0x41414141
0025eadc 41414141 41414141 41414141 41414141 0x41414141
0025eae0 41414141 41414141 41414141 41414141 0x41414141
0025eae4 41414141 41414141 41414141 41414141 0x41414141
0025eae8 41414141 41414141 41414141 41414141 0x41414141
0025eaec 41414141 41414141 41414141 41414141 0x41414141
0025eaf0 41414141 41414141 41414141 41414141 0x41414141
0025eaf4 41414141 41414141 41414141 41414141 0x41414141
0025eaf8 41414141 41414141 41414141 41414141 0x41414141
0025eafc 41414141 41414141 41414141 41414141 0x41414141
0025eb00 41414141 41414141 41414141 41414141 0x41414141
0025eb04 41414141 41414141 41414141 41414141 0x41414141
0025eb08 41414141 41414141 41414141 41414141 0x41414141
0025eb0c 41414141 41414141 41414141 41414141 0x41414141
0025eb10 41414141 41414141 41414141 41414141 0x41414141
0025eb14 41414141 41414141 41414141 41414141 0x41414141
0025eb18 41414141 41414141 41414141 41414141 0x41414141
0025eb1c 41414141 41414141 41414141 41414141 0x41414141
0025eb20 41414141 41414141 41414141 41414141 0x41414141
0025eb24 41414141 41414141 41414141 41414141 0x41414141
0025eb28 41414141 41414141 41414141 41414141 0x41414141
0025eb2c 41414141 41414141 41414141 41414141 0x41414141
0025eb30 41414141 41414141 41414141 41414141 0x41414141
0025eb34 41414141 41414141 41414141 41414141 0x41414141
0025eb38 41414141 41414141 41414141 41414141 0x41414141
0025eb3c 41414141 41414141 41414141 41414141 0x41414141
0025eb40 41414141 41414141 41414141 41414141 0x41414141
0025eb44 41414141 41414141 41414141 41414141 0x41414141
0025eb48 41414141 41414141 41414141 41414141 0x41414141
0025eb4c 41414141 41414141 41414141 41414141 0x41414141
0025eb50 41414141 41414141 41414141 41414141 0x41414141
0025eb54 41414141 41414141 41414141 41414141 0x41414141
0025eb58 41414141 41414141 41414141 41414141 0x41414141
0025eb5c 41414141 41414141 41414141 41414141 0x41414141
0025eb60 41414141 41414141 41414141 41414141 0x41414141
0025eb64 41414141 41414141 41414141 41414141 0x41414141
0025eb68 41414141 41414141 41414141 41414141 0x41414141
0025eb6c 41414141 41414141 41414141 41414141 0x41414141
0025eb70 41414141 41414141 41414141 41414141 0x41414141
0025eb74 41414141 41414141 41414141 41414141 0x41414141
0025eb78 41414141 41414141 41414141 41414141 0x41414141
0025eb7c 41414141 41414141 41414141 41414141 0x41414141
0025eb80 41414141 41414141 41414141 41414141 0x41414141
0025eb84 41414141 41414141 41414141 41414141 0x41414141
0025eb88 41414141 41414141 41414141 41414141 0x41414141
0025eb8c 41414141 41414141 41414141 41414141 0x41414141
0025eb90 41414141 41414141 41414141 41414141 0x41414141
0025eb94 41414141 41414141 41414141 41414141 0x41414141
0025eb98 41414141 41414141 41414141 41414141 0x41414141
0025eb9c 41414141 41414141 41414141 41414141 0x41414141
0025eba0 41414141 41414141 41414141 41414141 0x41414141
0025eba4 41414141 41414141 41414141 41414141 0x41414141
0025eba8 41414141 41414141 41414141 41414141 0x41414141
0025ebac 41414141 41414141 41414141 41414141 0x41414141
0025ebb0 41414141 41414141 41414141 41414141 0x41414141
0025ebb4 41414141 41414141 41414141 41414141 0x41414141
0025ebb8 41414141 41414141 41414141 41414141 0x41414141
0025ebbc 41414141 41414141 41414141 41414141 0x41414141
0025ebc0 41414141 41414141 41414141 41414141 0x41414141
0025ebc4 41414141 41414141 41414141 41414141 0x41414141
0025ebc8 41414141 41414141 41414141 41414141 0x41414141
0025ebcc 41414141 41414141 41414141 41414141 0x41414141
0025ebd0 41414141 41414141 41414141 41414141 0x41414141
0025ebd4 41414141 41414141 41414141 41414141 0x41414141
0025ebd8 41414141 41414141 41414141 41414141

SYMBOL_STACK_INDEX:  0

SYMBOL_NAME:  dwStg+172f

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: dwStg

DEBUG_FLR_IMAGE_TIMESTAMP:  3a15819d

STACK_COMMAND:  ~0s ; kb

BUCKET_ID:  APPLICATION_FAULT_STRING_DEREFERENCE_INVALID_POINTER_READ_FILL_PATTE
RN_41414141_dwStg+172f

IMAGE_NAME:  C:\Program Files\SEL\SEL5010\dwStg.dll

FAILURE_BUCKET_ID:  STRING_DEREFERENCE_FILL_PATTERN_41414141_c0000005_C:_Program
_Files_SEL_SEL5010_dwStg.dll!Unknown

WATSON_STAGEONE_URL:  http://watson.microsoft.com/StageOne/wscript_exe/5_8_7600_
16385/4a5bc678/dwStg_dll/2_5_0_26/3a15819d/c0000005/0000172f.htm?Retriage=1

Followup: MachineOwner
0:000> !exchain
0025ecb8: 41414141
Invalid exception stack at 41414141
0:000> !exploitable
Exploitability Classification: PROBABLY_EXPLOITABLE
Recommended Bug Title: Probably Exploitable - Data from Faulting Address contro
s Code Flow starting at dwStg+0x000000000000172f (Hash=0x3c3b3f4b.0x6d497b06)

The data from the faulting address is later used as the target for a branch.
0:000> lmvm dwStg
start    end        module name
10000000 10029000   dwStg    C (export symbols)       C:\Program Files\SEL\SEL5
10\dwStg.dll
    Loaded symbol image file: C:\Program Files\SEL\SEL5010\dwStg.dll
    Image path: C:\Program Files\SEL\SEL5010\dwStg.dll
    Image name: dwStg.dll
    Timestamp:        Fri Nov 17 13:06:05 2000 (3A15819D)
    CheckSum:         00000000
    ImageSize:        00029000
    File version:     2.5.0.26
    Product version:  2.5.0.0
    File flags:       0 (Mask 3F)
    File OS:          4 Unknown Win32
    File type:        2.0 Dll
    File date:        00000000.00000000
    Translations:     0409.04b0
    CompanyName:      Desaware, Inc.
    ProductName:      StorageTools 2.5
    InternalName:     Storage
    OriginalFilename: dwStg.dll
    ProductVersion:   2.5
    FileVersion:      2.5.0.26
    FileDescription:  Desaware StorageTools ATL Storage Component
    LegalCopyright:   Copyright ‚åê 2000 Desaware, Inc. All Rights Reserved.
    LegalTrademarks:  StorageTools is a trademark of Desaware, Inc.

//debug
